<div fxLayout="column" fxLayoutAlign="center" fxFill>
  <div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign="center">
    <mat-card>
      <div tabindex="-1" id="message" class="visually-hidden">{{ 'content.a11y-archived-contents' | translate }}</div>
      <div fxLayout="row" fxLayoutAlign="start center">
        <div class="cardTitle">
          <h2 *ngIf="!creationMode">{{ 'content.archived-contents' | translate }}</h2>
          <mat-form-field *ngIf="creationMode">
            <input id="content-group-input" matInput maxlength="25" [(ngModel)]="newName" aria-labelledby="enter-content-group-name">
            <mat-placeholder>{{ 'content.content-group-name' | translate }}</mat-placeholder>
          </mat-form-field>
        </div>
        <span class="fill-remaining-space"></span>
        <div fxLayoutGap="15px">
          <button *ngIf="creationMode" mat-raised-button class="button-abort" (click)="exitCreation()" aria-labelledby="cancel">
            {{ 'content.cancel' | translate }}
          </button>
          <button mat-raised-button class="button-primary" (click)="createNewGroup()" aria-labelledby="create">
            {{ ( creationMode ? 'content.create' : 'content.create-group-with-archived-contents') | translate }}
          </button>
        </div>
      </div>
      <mat-card-content>
        <p class="info-text">{{ 'content.archived-contents-description' | translate }}</p>
        <app-loading-indicator *ngIf="isLoading" [size]="50"></app-loading-indicator>
        <div *ngIf="!isLoading">
          <mat-list>
            <mat-list-item *ngFor="let content of contents; index as i"
                           attr.aria-label="{{ 'content.a11y-selected-content' | translate: { name: content.body } }}">
              <div class="bottom-border" fxLayout="row" fxLayoutAlign="space-between center" fxFill>
                <mat-checkbox *ngIf="creationMode" (click)="$event.stopPropagation()" [(ngModel)]="creationSelection[i]">
                </mat-checkbox>
                <p class="ellipsis">
                  {{ content.body }}
                </p>
                <button mat-icon-button (keyup.enter)="menuTrigger.openMenu()" #menuTrigger="matMenuTrigger"
                        [matMenuTriggerFor]="moreActions" (click)="$event.stopPropagation()"
                        class="moreButton" matTooltip="{{ 'content.more-options' | translate}}">
                  <mat-icon>more_vert</mat-icon>
                </button>
              </div>

              <mat-menu #moreActions="matMenu" xPosition="before">
                <button mat-menu-item (click)="editContent(content)" attr.aria-label="{{ 'content.a11y-edit-content' | translate }}">
                  <mat-icon>edit</mat-icon>
                  <span> {{ 'content.edit-content' | translate}}</span>
                </button>
                <button mat-menu-item [matMenuTriggerFor]="chooseGroups" attr.aria-label="{{ 'content.a11y-add-to-content-group' | translate }}">
                  <mat-icon>library_add</mat-icon>
                  <span>{{ 'content.add-content-to-group' | translate}}</span>
                </button>
                <button mat-menu-item (click)="deleteContent(content)" attr.aria-label="{{ 'content.a11y-delete-content' | translate }}">
                  <mat-icon class="delete">delete_forever</mat-icon>
                  <span>{{ 'content.delete-content' | translate}}</span>
                </button>
              </mat-menu>

              <mat-menu #chooseGroups="matMenu" xPosition="before">
                <button mat-menu-item *ngFor="let cg of contentGroups; index as i" [disabled]="i === currentGroupIndex"
                        (click)="addToContentGroup(content.id, cg, false, true)"
                        attr.aria-label="{{ 'content.a11y-add-to-this-content-group' | translate: { name: cg } }}">
                  <span>{{ cg }}</span>
                </button>
                <button mat-menu-item (click)="showContentGroupCreationDialog(content.id, true)" attr.aria-label="{{ 'content.a11y-new-content-group' | translate }}">
                  <mat-icon>add</mat-icon>
                  <span>{{ 'content.new-content-group' | translate}}</span>
                </button>
              </mat-menu>

            </mat-list-item>
          </mat-list>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<div class="visually-hidden">
  <div id="enter-content-group-name">{{ 'content.a11y-enter-content-group-name' | translate }}</div>
  <div id="edit-content-group-name">{{ 'content.a11y-edit-content-group-name' | translate }}</div>
  <div id="discard-changes">{{ 'content.a11y-discard-changes' | translate }}</div>
  <div id="save-changes">{{ 'content.a11y-save-changes' | translate }}</div>
  <div id="more">{{ 'content.a11y-more-options' | translate }}</div>
  <div id="cancel">{{ 'content.a11y-archived-cancel' | translate }}</div>
  <div id="create">{{ (creationMode ? 'content.a11y-archived-create-with-name' : 'content.a11y-archived-create') | translate: { name: newName } }}</div>
</div>

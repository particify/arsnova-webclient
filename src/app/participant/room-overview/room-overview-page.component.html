<div
  class="overview-container"
  fxLayout="column"
  fxLayoutAlign="start center"
  fxLayoutGap="16px"
  fxLayoutGap.lt-lg="12px"
>
  <div [appAutofocus] tabIndex="-1" class="visually-hidden">
    {{ 'room-page.a11y-room-message' | a11yIntro: { name: room.name } | async }}
  </div>
  @if (isLoading()) {
    <app-loading-indicator></app-loading-indicator>
  } @else {
    @let _shortId = shortId();
    @if (_shortId) {
      @let anyFeatureEnabled =
        commentsEnabled || feedbackEnabled || contentGroups.length > 0;
      @if (!focusModeEnabled()) {
        @if (description() && anyFeatureEnabled) {
          <app-expandable-card>
            <app-rendered-text
              [rawText]="description()"
              [renderedText]="descriptionRendered()"
              appLangContext
              appDirContext
            ></app-rendered-text>
          </app-expandable-card>
        }
        @if (commentsEnabled || feedbackEnabled) {
          <div
            fxFill
            [ngClass]="{
              'overview-row-container': commentsEnabled && feedbackEnabled,
            }"
          >
            @if (commentsEnabled) {
              <app-comments-card
                class="feature-row-item"
                [room]="legacyRoom()"
                [description]="
                  'participant.room-page.comments-description' | transloco
                "
                [pausedDescription]="
                  'participant.room-page.comments-description-paused'
                    | transloco
                "
                [showCount]="true"
                [clickable]="true"
              >
              </app-comments-card>
            }
            @if (feedbackEnabled) {
              <app-live-feedback-card
                class="feature-row-item"
                [room]="legacyRoom()"
                [description]="
                  'participant.room-page.live-feedback-description' | transloco
                "
                [showCount]="true"
                [clickable]="true"
                [feedbackEnabled]="true"
              >
              </app-live-feedback-card>
            }
          </div>
        }
        @if (isLoadingGroups()) {
          <app-loading-indicator></app-loading-indicator>
        } @else if (contentGroups && contentGroups.length > 0) {
          <app-feature-card
            class="feature-column-item"
            [ngClass]="{ disabled: focusModeEnabled() }"
            [feature]="'content.groups' | transloco"
            [description]="
              'participant.room-page.content-groups-description' | transloco
            "
            icon="equalizer"
            [fillFeatureAction]="true"
          >
            <ng-container featureActionFill>
              <div fxLayout="column" fxLayoutGap="8px">
                @for (contentGroup of contentGroups; track contentGroup) {
                  <app-content-groups
                    [contentGroup]="contentGroup"
                    [role]="viewRole()"
                    [shortId]="_shortId"
                    [showRipple]="true"
                  ></app-content-groups>
                }
              </div>
            </ng-container>
          </app-feature-card>
        }
      }
      @let roomName = room()?.name;
      @if ((!anyFeatureEnabled || focusModeEnabled()) && !!roomName) {
        <app-room-info-component
          style="max-width: 100%"
          [name]="roomName"
          [shortId]="_shortId"
          [description]="descriptionRendered()"
          [focusModeEnabled]="!!focusModeEnabled()"
        ></app-room-info-component>
      }
    }
  }
</div>
